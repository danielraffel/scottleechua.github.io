---
layout: post
title:  Versioning comic scripts using Fountain and GitHub
date:   2022-05-25
description: A plaintext walkthrough of writing and sharing auto-updating comic scripts using Fountain, <i>&#8217;afterwriting</i>, and GitHub Actions.
---

<img class="img-fluid rounded" src="{{ site.baseurl }}/assets/img/comic-script-diagram.png" alt="web architecture diagram explained below">

[I'm sold on this workflow, jump to the tutorial!](#setup)

---

## Why this workflow?

I write comic scripts in [Fountain](https://fountain.io), an open-format filetype for scripts and screenplays, and export them to PDF to send to my collaborators (artists, coauthors, publishers).

Previously, each new draft would result in a sheepish email to everyone involved, asking them to please ignore the previous draft and see bullet points below for the summary of changes. This was untenable.

I wanted a workflow that enables my collaborators to:
1. inspect the **exact, line-by-line edits** between any two drafts; and
2. access the **latest version** of the script in PDF,

while I write and overwrite the same single file all throughout (i.e., none of [this](https://phdcomics.com/comics.php?f=1531)).

In short, I wanted to implement [version control](https://git-scm.com/book/en/v2/Getting-Started-About-Version-Control).

The workflow I settled on is straightforward: I push my `.fountain` script files to a [GitHub](https://github.com/) repository, then use [<i>&#8217;afterwriting</i>](https://afterwriting.com/), an open-source Fountain converter, to automatically keep the PDF versions up-to-date.

Requirement (1) is satisfied because Fountain files are plaintext, and thus compatible with GitHub's compare (`diff`) feature. Requirement (2) is satisfied because <i>&#8217;afterwriting</i> has a command line interface that can be automated with [GitHub Actions](https://github.com/features/actions).

When all is said and done, the repo looks something like this:

<img class="img-fluid rounded" src="{{ site.baseurl }}/assets/img/comic-script-repo.png" alt="GitHub repo with .fountain files in the root folder, and a subfolder entitled PDF">

with the `.fountain` files in the root folder, and the PDF files in the `/pdf` subfolder.

## Why use Fountain?
Fountain is a formatting convention for writing scriptlike documents. Here is a comic script written in Fountain:

```
# Page 1

.Panel 1

It's dark. A coffee cup in the foreground. In midground, ALYSSA on the phone.

ALYSSA
*Uh-huh...*
```

**Fountain is free.** Like [Markdown](https://www.markdownguide.org/basic-syntax/), Fountain files are **nothing more than plaintext files** saved with a `.fountain` extension. Unlike Final Draft, Word, or Google Doc files, which require costly [^1] and proprietary software to view and edit, `.fountain` files can be read and edited on literally any computer.[^2]

**Fountain is futureproof.** Proprietary software may ~~force~~ strongly encourage you to [upgrade to the latest version](https://store.finaldraft.com/final-draft-12-upgrade.html) or [change your file formats](https://support.microsoft.com/en-us/office/converting-documents-to-a-newer-format-34ec742e-f0f9-4d95-bbe3-3ee8e30a86fa), but your computer will always have a text editor. This makes Fountain ideal for storing scripts without worrying about software obsolescence or incompatibilities.

**Fountain exports to the usual file formats.** While plaintext Fountain already looks rather "script-like," free converter software can parse the special formatting rules[^3] into a nicely-rendered PDF:

<img class="img-fluid rounded" src="{{ site.baseurl }}/assets/img/comic-script-exported-pdf.png" alt="formatted version of plaintext above">

(If you must, Fountain also exports nicely to Final Draft.)

## Setup

1. Make a GitHub account, create a new private repository, and [clone](https://docs.github.com/en/repositories/creating-and-managing-repositories/cloning-a-repository) it to your local computer. Let's call this folder `my-script-repo`.
2. Open a text editor.[^4] Create a text file called `.gitignore` in `my-script-repo` containing:
    ```
    .DS_Store
    desktop.ini
    ```
    
3. Move your Fountain script file into `my-script-repo`. Let's call it `script.fountain`.
4. Create a text file called `config.json` in `my-script-repo` containing:
    ```
    {
	    "embolden_scene_headers": true,
	    "show_page_numbers": true,
	    "split_dialogue": true,
	    "print_title_page": true,
	    "print_profile": "a4",
	    "double_space_between_scenes": false,
	    "print_sections": true,
	    "print_synopsis": true,
	    "print_actions": true,
	    "print_headers": true,
	    "print_dialogues": true,
	    "number_sections": false,
	    "use_dual_dialogue": true,
	    "print_notes": true,
	    "print_header": "",
	    "print_footer": "",
	    "print_watermark": "",
	    "scenes_numbers": "none",
	    "each_scene_on_new_page": false
	}
    ```
    This config file customizes the PDF output generated by <i>&#8217;afterwriting</i>. Customize these settings as you like; refer to the [documentation](https://github.com/ifrost/afterwriting-labs/blob/master/docs/clients.md) for a complete list of available settings.

5. Create a subfolder `my-script-repo/pdf`. Inside it, create an empty text file called `.gitkeep`.
6. Add, commit, then push this first set of changes to GitHub. (For help, see [here](https://www.earthdatascience.org/workshops/intro-version-control-git/basic-git-commands/).) At this stage, your folder structure should look like:
    ```
    .
    └── my-script-repo/
        ├── .gitignore
        ├── script.fountain
        ├── config.json
        ├── pdf/
        │   └── .gitkeep
        └── .git/
            └── << ignore these files >>
    ```

7. Go to `my-script-repo` on GitHub. Click on `Actions` > `New Workflow`.
8. Click on Simple Workflow > `Configure`.
9. Rename the file from `blank.yml` to `fountain_to_pdf.yml`. Replace the contents of the text box with:

    ``` yaml
    name: fountain_to_pdf

    on:
      push:
        branches:
          - main
      workflow_dispatch:

    jobs:
      convert_files:
        name: Convert Fountain to PDF
        runs-on: ubuntu-latest
        permissions:
          contents: write
        steps:
          # Check out your repository
          - uses: actions/checkout@v3
          
          # Install 'afterwriting
          - name: Install 'afterwriting
            run: npm install afterwriting -g

          # Invoke 'afterwriting to export script.fountain to script.pdf
          - name: Generate PDF
            run: afterwriting --source script.fountain --pdf pdf/script.pdf --overwrite --config config.json

          # Commits changes
          - uses: stefanzweifel/git-auto-commit-action@v4
    ```
    
    If you have multiple `.fountain` files, the `afterwiting --source ...` command must be invoked separately per file. For example, if you have three chapters `C1.fountain`, `C2.fountain`, and `C3.fountain`, replace the appropriate lines above with:
    ``` yaml
    # Invoke 'afterwriting to export script.fountain to script.pdf
          - name: Generate PDF
            run: |
              afterwriting --source C1.fountain --pdf pdf/C1.pdf --overwrite --config config.json
              afterwriting --source C2.fountain --pdf pdf/C2.pdf --overwrite --config config.json
              afterwriting --source C3.fountain --pdf pdf/C3.pdf --overwrite --config config.json
    ```
    where the vertical delimiter `|` indicates that GitHub should run multiple commands instead of just one.
    
10. To the upper right of the text box, click `Start commit` > `Commit new file`.

11. Pull the changes to your local machine. Your folder structure should now look like:
    ```
    .
    └── my-script-repo/
        ├── .gitignore
        ├── script.fountain
        ├── config.json
        ├── pdf/
        │   └── .gitkeep
        ├── .git/
        │   └── << ignore these files >>
        └── .github/
            └── workflows/
                └── fountain_to_pdf.yml    
    ```
    Setup is complete!

## Update your script

At this point, your `pdf/` subfolder is still empty, as you haven't pushed any new commits yet. Let's do that now.

1. Make some edits to `script.fountain`.
2. Add, commit, and push the edits to GitHub.
3. Allow the workflow to run. You can track its progress on GitHub, under `Actions`.
4. Once the workflow has completed, go back to your local and pull changes from GitHub. A new file `script.pdf` should now appear under the `pdf/` subfolder.

If you don't want [merge conflicts](https://happygitwithr.com/pull-tricky.html) (and you don't), **always pull the newly-updated PDF after every push!**

---

## Congratulations!
At this point, the workflow has been set up and you know how to update your scripts. Now your collaborators can see the latest edits for a given file by clicking on its latest commit:[^5]

<img class="img-fluid rounded" src="{{ site.baseurl }}/assets/img/comic-script-click-commit.png" alt="GitHub repo with mouse hovering over the latest commit for file k1.fountain">

which leads them to a page with line-by-line comparisons:

<img class="img-fluid rounded" src="{{ site.baseurl }}/assets/img/comic-script-diff.png" alt="GitHub diff file for file k1.fountain">

Your collaborators can also view the latest PDFs by going to the [GitHub website](https://github.com/) or by pulling the latest changes to their local repo.

### Contribute
This walkthrough last worked for me in May 2022. If you spot errors, vulnerabilities, or potential improvements, please do [open a pull request](https://google.com) on this blog post!

### Acknowledgements
This tutorial owes a deep debt of gratitude to Piotr Jamr&oacute;z and the rest of the [<i>&#8217;afterwriting</i>](https://afterwriting.com/) team. (So do I!)

---
#### Footnotes

[^1]: While Google Docs is technically free, a stable internet connection is not.
[^2]: Free Fountain-specific scriptwriting apps with syntax highlighting and other quality-of-life features are also available, such as [Beat](https://kapitan.fi/beat/) (Mac) or [Trelby](https://www.trelby.org/) (Windows, Linux).
[^3]: For instance, section headings begin with `#`; scene headings begin with `.`; character names are in all caps. Read the full syntax guide [here](https://fountain.io/syntax).
[^4]: Every operating system has one by default, e.g., [Notepad](https://apps.microsoft.com/store/detail/9MSMLRH6LZF3?hl=en-us&gl=US) on Windows, [TextEdit](https://support.apple.com/en-ph/guide/textedit/welcome/mac) on Mac.
[^5]: Read the [GitHub documentation](https://docs.github.com/en/pull-requests/committing-changes-to-your-project/viewing-and-comparing-commits/comparing-commits) for more ways to compare commits.